$\newcommand{\abs}[1]{\left|#1\right|}$

# Линейная регрессия

## Класс MyLineReg -- модель линейной регрессии.

### Параметры инициализации
1. `n_iter` -- количество шагов градиентного спуска. По умолчанию: 100

2. `learning_rate` -- коэффициент скорости обучения графиентного спуска. По умолчанию: 0.1.
Может быть функцией от одного аргумента, возвращающая значение скорости обучения зависющее от текущей итерации. Пример:
```py
    lambda iter: 0.5 * (0.85 ** iter)
```

3. `metric` -- название метрики. По умолчанию: None
    - mae: $MAE(a, b) = 1 / N \cdot \sum_{i=1}^{N} \abs{a_i - b_i}$
    - mse: $MAE(a, b) = 1 / N \cdot \sum_{i=1}^{N} (a_i - b_i)^2$
    - rmse: $MAE(a, b) = \sqrt{1 / N \cdot \sum_{i=1}^{N} (a_i - b_i)^2}$
    - mape: $MAPE(a, b) = 100 / N \cdot \sum_{i=1}^{N}\abs{\frac{a_i - b_i}{a_i}}$
    - r2: $R^2(a, b) = 1 - \frac{\sum_{i=1}^{N}(a_i - b_i)^2}{\sum_{i=1}^{N}(b_i - b_{arg})}$

4. `reg` -- название метода регуляризации. По умолчанию: None
    - l1: $C \cdot \sum \abs{weights}$
    - l2: $C \cdot \sum weights^2$
    - elasticnet: $l1 + l2$
5. `l1_coef` -- коэффициент при `l1` регуляризации. Принимает значения от 0.0 до 1.0. По умолчанию: 0

6. `l2_coef` -- коэффициент при `l2` регуляризации. Принимает значения от 0.0 до 1.0. По умолчанию: 0

7. `sgd_sample` -- размер батча, для обучения SGD. Принимает целые числа как количество и вещественные от 0.0 до 0.1 как доля от размера датасета. По умолчанию: None

8. `random_state` -- параметр еобходимы для воспроизводительности результатов. В начале каждой итерации сформируем порядковые номера строк, которые стоит отобрать. По умолчанию: 42

### Методы
1. `fit` -- обучение модели. Принемает:
    - X -- матрица объекты-признаки (датафрейм)
    - y -- вектор целевая переменная (пандасовская серия)
    - verbose -- указывает через сколько итераций выводить лог. По умолчанию: None

2. `predict` -- предсказание по входящей матрице объекты-признаки

3. `get_coef` -- возвращает значения весов, вектор

4. `get_best_score` -- последние значение метрики (полностью обученной модели)
